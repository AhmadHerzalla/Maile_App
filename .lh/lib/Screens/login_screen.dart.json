{
    "sourceFile": "lib/Screens/login_screen.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1693750468458,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1693750468458,
            "name": "Commit-0",
            "content": "import 'dart:convert';\r\n\r\nimport 'package:final_projectt/Screens/main_screen.dart';\r\nimport 'package:final_projectt/core/helpers/shared_prefs.dart';\r\nimport 'package:final_projectt/core/services/auth_controller.dart';\r\nimport 'package:final_projectt/core/util/constants/colors.dart';\r\nimport 'package:final_projectt/core/widgets/show_alert.dart';\r\nimport 'package:final_projectt/models/user_model.dart';\r\nimport 'package:flutter/material.dart';\r\nimport 'package:icons_plus/icons_plus.dart';\r\nimport 'package:toggle_switch/toggle_switch.dart';\r\n\r\nclass LoginScreen extends StatefulWidget {\r\n  const LoginScreen({super.key});\r\n\r\n  @override\r\n  State<LoginScreen> createState() => _LoginScreenState();\r\n}\r\n\r\nclass _LoginScreenState extends State<LoginScreen> {\r\n  bool isToggled = false;\r\n  int initialLabelIndex = 0;\r\n  final _formKey = GlobalKey<FormState>();\r\n  TextEditingController nameController = TextEditingController();\r\n  TextEditingController emailOrUserNameController = TextEditingController();\r\n  TextEditingController passController = TextEditingController();\r\n  TextEditingController confirmPassController = TextEditingController();\r\n\r\n  void submitRegister() {\r\n    if (_formKey.currentState!.validate()) {\r\n      AuthController.register(context,\r\n              name: nameController.text,\r\n              email: emailOrUserNameController.text,\r\n              password: passController.text,\r\n              passwordConfirmation: confirmPassController.text)\r\n          .then((response) async {\r\n        showAlert(context,\r\n            message: \"Account Created Successfully,\\n Please Log In\",\r\n            color: Colors.grey,\r\n            width: 300);\r\n        Navigator.pushReplacement(context, MaterialPageRoute(\r\n          builder: (context) {\r\n            return LoginScreen();\r\n          },\r\n        ));\r\n      }).catchError((err) async {\r\n        final errorMessagae =\r\n            json.decode(err.message)['errors']['email'][0].toString();\r\n        showAlert(context,\r\n            message: errorMessagae, color: Colors.redAccent, width: 300);\r\n      });\r\n    }\r\n  }\r\n\r\n  void submitLogin() {\r\n    if (_formKey.currentState!.validate()) {\r\n      AuthController.login(\r\n        context,\r\n        email: emailOrUserNameController.text,\r\n        password: passController.text,\r\n      ).then((response) async {\r\n        SharedPrefsController prefs = SharedPrefsController();\r\n        await prefs.setData('user', userToJson(User.fromJson(response[1])));\r\n        Navigator.pushReplacement(context, MaterialPageRoute(\r\n          builder: (context) {\r\n            return const MainPage();\r\n          },\r\n        ));\r\n      }).catchError((err) async {\r\n        final errorMessagae = json.decode(err.message)['message'].toString();\r\n        showAlert(context,\r\n            message: errorMessagae, color: Colors.redAccent, width: 300);\r\n      });\r\n    }\r\n  }\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    return Scaffold(\r\n        backgroundColor: const Color.fromARGB(255, 234, 229, 229),\r\n        body: GestureDetector(\r\n          onTap: () {\r\n            FocusScope.of(context).unfocus();\r\n          },\r\n          child: SingleChildScrollView(\r\n            physics: const BouncingScrollPhysics(),\r\n            child: Stack(\r\n              alignment: Alignment.topCenter,\r\n              children: [\r\n                Container(\r\n                  clipBehavior: Clip.antiAliasWithSaveLayer,\r\n                  width: 400,\r\n                  height: 400,\r\n                  decoration: const BoxDecoration(\r\n                    color: Colors.white,\r\n                    borderRadius: BorderRadius.only(\r\n                        bottomLeft: Radius.circular(110),\r\n                        bottomRight: Radius.circular(200)),\r\n                  ),\r\n                  child: Image.asset(\r\n                    'images/splash.jpg',\r\n                    fit: BoxFit.cover,\r\n                  ),\r\n                ),\r\n                Container(\r\n                  margin: const EdgeInsets.only(top: 220),\r\n                  width: 350,\r\n                  height: isToggled ? 570 : 470,\r\n                  decoration: BoxDecoration(\r\n                      color: Colors.white,\r\n                      borderRadius: BorderRadius.circular(80)),\r\n                  child: Padding(\r\n                    padding: const EdgeInsetsDirectional.only(\r\n                      top: 60.0,\r\n                      end: 60.0,\r\n                      start: 60.0,\r\n                    ),\r\n                    child: Column(\r\n                      children: [\r\n                        ToggleSwitch(\r\n                          fontSize: 16,\r\n                          minWidth: 100.0,\r\n                          cornerRadius: 20.0,\r\n                          activeBgColors: [\r\n                            [Colors.blue[800]!],\r\n                            [Colors.blue[800]!]\r\n                          ],\r\n                          activeFgColor: Colors.white,\r\n                          inactiveBgColor:\r\n                              const Color.fromARGB(255, 234, 232, 232),\r\n                          inactiveFgColor: Colors.blue[800]!,\r\n                          initialLabelIndex: initialLabelIndex,\r\n                          totalSwitches: 2,\r\n                          labels: const ['Log In', 'Sign Up'],\r\n                          radiusStyle: true,\r\n                          onToggle: (index) {\r\n                            setState(() {\r\n                              isToggled = !isToggled;\r\n                              initialLabelIndex = index!;\r\n                            });\r\n                          },\r\n                        ),\r\n                        SizedBox(height: 30),\r\n                        Form(\r\n                          key: _formKey,\r\n                          child: Column(\r\n                            children: [\r\n                              if (isToggled)\r\n                                TextFormField(\r\n                                  controller: nameController,\r\n                                  validator: (value) {\r\n                                    if (value == null || value.isEmpty) {\r\n                                      return 'Please enter your name';\r\n                                    }\r\n                                    return null;\r\n                                  },\r\n                                  decoration: InputDecoration(\r\n                                      hintText: 'Enter your name',\r\n                                      hintStyle: TextStyle(\r\n                                          color: Colors.grey,\r\n                                          fontFamily: 'Iphone',\r\n                                          fontSize: 14),\r\n                                      fillColor: Colors.grey,\r\n                                      enabledBorder: UnderlineInputBorder(\r\n                                          borderSide:\r\n                                              BorderSide(color: Colors.grey)),\r\n                                      focusedBorder: UnderlineInputBorder(\r\n                                          borderSide:\r\n                                              BorderSide(color: Colors.grey))),\r\n                                ),\r\n                              TextFormField(\r\n                                controller: emailOrUserNameController,\r\n                                validator: (value) {\r\n                                  if (value == null || value.isEmpty) {\r\n                                    return 'Please enter email or username';\r\n                                  }\r\n                                  return null;\r\n                                },\r\n                                decoration: InputDecoration(\r\n                                    hintText: 'Enter email or username',\r\n                                    hintStyle: TextStyle(\r\n                                        color: Colors.grey,\r\n                                        fontFamily: 'Iphone',\r\n                                        fontSize: 14),\r\n                                    fillColor: Colors.grey,\r\n                                    enabledBorder: UnderlineInputBorder(\r\n                                        borderSide:\r\n                                            BorderSide(color: Colors.grey)),\r\n                                    focusedBorder: UnderlineInputBorder(\r\n                                        borderSide:\r\n                                            BorderSide(color: Colors.grey))),\r\n                              ),\r\n                              SizedBox(\r\n                                height: 15,\r\n                              ),\r\n                              TextFormField(\r\n                                controller: passController,\r\n                                obscureText: true,\r\n                                validator: (value) {\r\n                                  if (value == null || value.isEmpty) {\r\n                                    return ' Please enter a password  ';\r\n                                  }\r\n                                  return null;\r\n                                },\r\n                                decoration: InputDecoration(\r\n                                    hintText: 'Password',\r\n                                    hintStyle: TextStyle(\r\n                                        color: Colors.grey,\r\n                                        fontFamily: 'Iphone',\r\n                                        fontSize: 14),\r\n                                    fillColor: Colors.grey,\r\n                                    enabledBorder: UnderlineInputBorder(\r\n                                        borderSide:\r\n                                            BorderSide(color: Colors.grey)),\r\n                                    focusedBorder: UnderlineInputBorder(\r\n                                        borderSide:\r\n                                            BorderSide(color: Colors.grey))),\r\n                              ),\r\n                              SizedBox(\r\n                                height: 15,\r\n                              ),\r\n                              if (isToggled)\r\n                                Column(\r\n                                  children: [\r\n                                    TextFormField(\r\n                                      controller: confirmPassController,\r\n                                      obscureText: true,\r\n                                      validator: (value) {\r\n                                        if (value == null || value.isEmpty) {\r\n                                          return 'Please confirm your password';\r\n                                        } else if (value !=\r\n                                            passController.text) {\r\n                                          return 'Passwords do not match';\r\n                                        }\r\n                                        return null;\r\n                                      },\r\n                                      decoration: InputDecoration(\r\n                                          hintText: 'Confirm Password',\r\n                                          hintStyle: TextStyle(\r\n                                              color: Colors.grey,\r\n                                              fontFamily: 'Iphone',\r\n                                              fontSize: 14),\r\n                                          fillColor: Colors.grey,\r\n                                          enabledBorder: UnderlineInputBorder(\r\n                                              borderSide: BorderSide(\r\n                                                  color: Colors.grey)),\r\n                                          focusedBorder: UnderlineInputBorder(\r\n                                              borderSide: BorderSide(\r\n                                                  color: Colors.grey))),\r\n                                    ),\r\n                                    SizedBox(\r\n                                      height: 25,\r\n                                    ),\r\n                                  ],\r\n                                ),\r\n                              TextButton(\r\n                                onPressed: () {\r\n                                  if (isToggled) {\r\n                                    if (_formKey.currentState!.validate()) {\r\n                                      submitRegister();\r\n                                    }\r\n                                  } else {\r\n                                    if (_formKey.currentState!.validate()) {\r\n                                      submitLogin();\r\n                                    }\r\n\r\n                                    // if (Form.of(context).validate()) {\r\n                                    //   Navigator.push(\r\n                                    //     context,\r\n                                    //     MaterialPageRoute(\r\n                                    //         builder: (context) =>\r\n                                    //             const HomeScreen()),\r\n                                    //   );\r\n                                    // }\r\n                                  }\r\n                                },\r\n                                style: ElevatedButton.styleFrom(\r\n                                  shape: RoundedRectangleBorder(\r\n                                    borderRadius: BorderRadius.circular(20.0),\r\n                                  ),\r\n                                ),\r\n                                child: Container(\r\n                                  width: double.infinity,\r\n                                  decoration: BoxDecoration(\r\n                                    color: primaryColor,\r\n                                    borderRadius: BorderRadius.circular(20.0),\r\n                                  ),\r\n                                  padding: EdgeInsets.symmetric(\r\n                                      vertical: 16.0, horizontal: 32.0),\r\n                                  child: Text(\r\n                                    isToggled ? 'Sign Up' : 'Log In',\r\n                                    textAlign: TextAlign.center,\r\n                                    style: TextStyle(\r\n                                      color: Colors.white,\r\n                                      fontSize: 16,\r\n                                    ),\r\n                                  ),\r\n                                ),\r\n                              ),\r\n                              SizedBox(\r\n                                height: 14,\r\n                              ),\r\n                              Text(\r\n                                'OR',\r\n                                textAlign: TextAlign.center,\r\n                                style: TextStyle(\r\n                                  color: Colors.grey,\r\n                                  fontSize: 14,\r\n                                ),\r\n                              ),\r\n                              SizedBox(height: 16),\r\n                              Row(\r\n                                mainAxisAlignment:\r\n                                    MainAxisAlignment.spaceEvenly,\r\n                                children: [\r\n                                  InkWell(\r\n                                    onTap: () {},\r\n                                    child: Container(\r\n                                      padding: EdgeInsetsDirectional.symmetric(\r\n                                        horizontal: 8,\r\n                                        vertical: 8,\r\n                                      ),\r\n                                      decoration: BoxDecoration(\r\n                                        borderRadius: BorderRadius.circular(20),\r\n                                        border: Border.all(\r\n                                            color: const Color.fromARGB(\r\n                                                255, 210, 208, 208)),\r\n                                      ),\r\n                                      child: Logo(\r\n                                        Logos.facebook_f,\r\n                                        size: 24,\r\n                                      ),\r\n                                    ),\r\n                                  ),\r\n                                  InkWell(\r\n                                    onTap: () {},\r\n                                    child: Container(\r\n                                      padding: EdgeInsets.symmetric(\r\n                                        horizontal: 8,\r\n                                        vertical: 8,\r\n                                      ),\r\n                                      decoration: BoxDecoration(\r\n                                        borderRadius: BorderRadius.circular(20),\r\n                                        border: Border.all(\r\n                                            color: const Color.fromARGB(\r\n                                                255, 210, 208, 208)),\r\n                                      ),\r\n                                      child: Logo(\r\n                                        Logos.twitter,\r\n                                        size: 24,\r\n                                      ),\r\n                                    ),\r\n                                  ),\r\n                                  InkWell(\r\n                                    onTap: () {},\r\n                                    child: Container(\r\n                                      padding: EdgeInsets.symmetric(\r\n                                        horizontal: 8,\r\n                                        vertical: 8,\r\n                                      ),\r\n                                      decoration: BoxDecoration(\r\n                                        borderRadius: BorderRadius.circular(20),\r\n                                        border: Border.all(\r\n                                            color: const Color.fromARGB(\r\n                                                255, 210, 208, 208)),\r\n                                      ),\r\n                                      child: Logo(\r\n                                        Logos.google,\r\n                                        size: 24,\r\n                                      ),\r\n                                    ),\r\n                                  ),\r\n                                ],\r\n                              ),\r\n                            ],\r\n                          ),\r\n                        ),\r\n                      ],\r\n                    ),\r\n                  ),\r\n                )\r\n              ],\r\n            ),\r\n          ),\r\n        ));\r\n  }\r\n}\r\n"
        }
    ]
}